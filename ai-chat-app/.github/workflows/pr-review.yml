name: Pull Request Review

on:
  pull_request:
    types: [opened, reopened]

jobs:
  review:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install dependencies
        run: npm ci

      - name: Run tests
        run: npm test

      - name: Run linting
        run: npm run lint

      - name: Add review comment
        uses: actions/github-script@v7
        with:
          script: |
            const { data: pullRequest } = await github.rest.pulls.get({
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: context.issue.number
            });

            await github.rest.pulls.createReview({
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: context.issue.number,
              event: 'COMMENT',
              body: 'ğŸ‘‹ ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é–‹å§‹ã—ã¾ã—ãŸã€‚\n\nä»¥ä¸‹ã®è¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡Œã„ã¾ã™ï¼š\n\n### 1. ã‚³ãƒ¼ãƒ‰ã®å“è³ª\n- ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã¨ä¿å®ˆæ€§\n- å‘½åè¦å‰‡ã®éµå®ˆ\n- é–¢æ•°ã‚„ã‚¯ãƒ©ã‚¹ã®è²¬å‹™ã®æ˜ç¢ºã•\n- ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ã®æœ‰ç„¡\n\n### 2. ãƒ†ã‚¹ãƒˆ\n- ãƒ†ã‚¹ãƒˆã®ç¶²ç¾…æ€§\n- ãƒ†ã‚¹ãƒˆã®å“è³ªã¨ä¿¡é ¼æ€§\n- ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®è€ƒæ…®\n\n### 3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£\n- å…¥åŠ›å€¤ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³\n- èªè¨¼ãƒ»èªå¯ã®é©åˆ‡ãªå®Ÿè£…\n- æ©Ÿå¯†æƒ…å ±ã®å–ã‚Šæ‰±ã„\n\n### 4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹\n- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªã®æœ€é©åŒ–\n- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®è€ƒæ…®\n- ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã¸ã®å½±éŸ¿\n\n### 5. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£\n- è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©åˆ‡ãªä½¿ç”¨\n- ä¾å­˜é–¢ä¿‚ã®ç®¡ç†\n- ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®è€ƒæ…®\n\nãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå®Œäº†ã™ã‚‹ã¾ã§ãŠå¾…ã¡ãã ã•ã„ã€‚'
            });
